{% extends 'base.html' %}
{% load static %}
{% block title %}Угрозы безопасности{% endblock %}
{% load news_tags %}
{% block content %}

<div class="large-12 columns">
    <div class="page-title">
        <h1>Угрозы безопасности</h1>

        <div class="breadcrumbs">
            <a href="{% url 'news:HomeView' %}" title="">Главная</a> / Угрозы
        </div>
    </div>
</div>

<div id="main" class="medium-8 large-8 columns">
    <div class="threat-filters">
        <div class="filter-group">
            <label>Уровень угрозы:</label>
            <select class="threat-level-filter">
                <option value="all">Все</option>
                <option value="high">Высокий</option>
                <option value="medium">Средний</option>
                <option value="low">Низкий</option>
            </select>
        </div>
        <div class="filter-group">
            <label>Статус:</label>
            <select class="threat-status-filter">
                <option value="all">Все</option>
                <option value="active">Активные</option>
                <option value="resolved">Разрешенные</option>
                <option value="investigating">В расследовании</option>
            </select>
        </div>
    </div>

    <div id="post-area">
        {% for post in page_obj %}
        <article class="post full-width slideUp2xRun threat-item {% if post.threat_level == 'high' %}high-threat{% elif post.threat_level == 'medium' %}medium-threat{% else %}low-threat{% endif %}">
            <div class="threat-header">
                <span class="threat-level-badge">{{ post.threat_level|title }}</span>
                <span class="threat-status">{{ post.status|title }}</span>
            </div>

            <a href="{% url 'news:post_detail' post.id %}" class="image-post item-overlay">
                <img src="{{ post.image.url }}" alt="">
            </a>

            <header class="entry-header">
                <h2 class="entry-title">
                    <a href="">{{ post.title }}</a>
                </h2>
                <div class="threat-meta">
                    <span class="threat-category">{{ post.category }}</span>
                    <span class="threat-date">{{ post.pub_date }}</span>
                </div>
            </header>

            <div class="entry-content">
                <p>
                    {{ post.content|truncatechars:200 }}...
                </p>
                <div class="threat-details">
                    <div class="detail-item">
                        <i class="fa fa-exclamation-triangle"></i>
                        <span>Влияние: {{ post.impact }}</span>
                    </div>
                    <div class="detail-item">
                        <i class="fa fa-clock"></i>
                        <span>Обнаружено: {{ post.detection_date }}</span>
                    </div>
                </div>
            </div>

            <footer class="entry-footer">
                <div class="left">
                    <span class="cat-links">
                        <a href="{% url 'news:post_detail' post.id %}" rel="category tag">Подробнее</a>
                    </span>
                </div>

                <div class="right">
                    <span class="posted-on"><a href="">{{ post.pub_date }}</a></span>
                    <span class="byline"><a href="">{{ post.author }}</a></span>
                    <span class="threat-views"><i class="fa fa-eye"></i> {{ post.views }}</span>
                </div>
            </footer>
        </article>
        {% endfor %}
    </div>

    <nav>
        <ul class="pagination">
            {% if page_obj.has_previous %}
                <li class="page-item">
                    <a class="page-link" href="?page=1">&laquo; Первая</a>
                </li>
                <li class="page-item">
                    <a class="page-link" href="?page={{ page_obj.previous_page_number }}">Предыдущая</a>
                </li>
            {% endif %}

            <li class="page-item">
                <a class="page-link" href="">
                    Страница {{ page_obj.number }} из {{ page_obj.paginator.num_pages }}
                </a>
            </li>

            {% if page_obj.has_next %}
                <li class="page-item">
                    <a class="page-link" href="?page={{ page_obj.next_page_number }}">Следующая</a>
                </li>
                <li class="page-item">
                    <a class="page-link" href="?page={{ page_obj.paginator.num_pages }}">Последняя &raquo;</a>
                </li>
            {% endif %}
        </ul>
    </nav>
</div>

<aside id="sidebar" class="medium-4 large-4 columns">
    {% include 'include/sidebar-area.html' %}
    
    <div class="widget widget_threat_statistics">
        <h3 class="widget-title">Статистика угроз</h3>
        <div class="threat-stats">
            <div class="stat-item">
                <span class="stat-label">Активные угрозы</span>
                <span class="stat-value high">3</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">В расследовании</span>
                <span class="stat-value medium">5</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Разрешенные</span>
                <span class="stat-value low">12</span>
            </div>
        </div>
    </div>

    <div class="widget widget_recent_threats">
        <h3 class="widget-title">Последние угрозы</h3>
        <div class="recent-threats-list">
            {% for post in recent_threats %}
            <div class="recent-threat-item">
                <div class="threat-info">
                    <h4><a href="{% url 'news:post_detail' post.id %}">{{ post.title }}</a></h4>
                    <span class="threat-date">{{ post.pub_date }}</span>
                </div>
                <span class="threat-level {{ post.threat_level }}">{{ post.threat_level|title }}</span>
            </div>
            {% endfor %}
        </div>
    </div>

    <div class="widget widget_security_tips">
        <h3 class="widget-title">Рекомендации по безопасности</h3>
        <div class="security-tips-list">
            <div class="tip-item">
                <i class="fa fa-lock"></i>
                <p>Регулярно меняйте пароли и используйте двухфакторную аутентификацию</p>
            </div>
            <div class="tip-item">
                <i class="fa fa-shield-alt"></i>
                <p>Не открывайте подозрительные ссылки и не скачивайте файлы из неизвестных источников</p>
            </div>
            <div class="tip-item">
                <i class="fa fa-user-shield"></i>
                <p>Сообщайте о подозрительной активности в службу безопасности</p>
            </div>
        </div>
    </div>
</aside>
{% endblock %}  
